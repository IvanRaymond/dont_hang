{% extends 'base.html.twig' %}

{% block title %}{{ 'home.title'|trans|raw }}{% endblock %}

{% block body %}
<style>

.container-flex {
  margin-left: 5em;
  margin-right: 5em;
}

.current-parties, .current-ranking {
  height: 100%;
  padding-bottom: 2em;
}

table {
  width:100%;
  height: 100%;
  border-collapse: collapse;
}

th {
  text-align: left;
}

.join {
  text-align: center;
}

.join > a {
  color: black;
}

td > div.join:hover {
  background-color: #eee;
  cursor: pointer;
}

</style>

<div class="container-flex">
  <div class="container-item">
    <h2>{{ 'home.table.game.title'|trans|raw }}</h2>
    <div class="current-parties">
      <table class="border lined thick">
        <thead>
          <tr>
            <th></th>
            <th>{{ 'home.table.game.name'|trans|raw }}</th>
            <th>{{ 'home.table.game.player_count'|trans|raw }}</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
           {% for room in rooms %}
             {% set activeCount = 0 %}
             {% for participant in room.roomParticipants %}
               {% if participant.isActive() %}
                 {% set activeCount = activeCount + 1 %}
               {% endif %}
             {% endfor %}
          <tr>
            <td class="{{ loop.last ? '' : 'bottom-bar' }}">{{ room.name }}</td>
            <td class="{{ loop.last ? '' : 'bottom-bar' }}">{{ activeCount }}/{{ room.capacity }}</td>
            <td>
              <div class="join border lined thick bottom-bar" onclick="goToLink(event)">
                <a class="join-link" href="{{ path('app_join_room', {'id': room.id}) }}">{{ 'home.table.game.join'|trans|raw }}</a>
              </div>
            </td>
          </tr>
           {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <div class="container-item">
    <h2>{{ 'home.table.ranking.title'|trans|raw }}</h2>

    <div class="current-ranking">
      <table class="border lined thick">
        <thead>
          <tr>
            <th></th>
            <th>{{ 'home.table.ranking.name'|trans|raw }}</th>
            <th>{{ 'home.table.ranking.games_won'|trans|raw }}/{{ 'home.table.ranking.games_lost'|trans|raw }}</th>
            <th>{{ 'home.table.ranking.score'|trans|raw }}</th>
          </tr>
        </thead>
        <tbody>
          {# {% for rank in ranks %} #}
          <tr>
            <td>
              <span>icon profile</span>
              {# <span>{{ rank.profile }}</span> #}
            </td>
            <td>
              <span>The boss</span>
              {# <span>{{ rank.name }}</span> #}
            </td>
            <td>
              <span>3/5</span>
              {# <span>{{ rank.win }}/{{ rank.lose }}</span> #}
            </td>
            <td>
              <span>59</span>
              {# <span>{{ rank.points }}</span> #}
            </td>
          </tr>
          {# {% endfor %} #}
        </tbody>
      </table>
    </div>
  </div> 
</div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>
    function goToLink(event) {
      const joinLink = event.currentTarget.querySelector('.join-link');
      window.location.href = joinLink.href;
    }
  </script>
{% endblock %}
