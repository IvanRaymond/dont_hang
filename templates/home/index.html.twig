{% extends 'base.html.twig' %}

{% block title %}{{ 'home.title'|trans|raw }}{% endblock %}

{% block body %}
<style>

.container-flex {
  margin-left: 5em;
  margin-right: 5em;
}

.current-parties, .current-ranking {
  height: 100%;
  padding-bottom: 2em;
}

.join {
  text-align: center;
}

.join > a {
  color: black;
}

.join:hover, .create-party:hover {
  background-color: #eee;
  cursor: pointer;
}

.current-parties > ul > li:nth-child(1) > .join {
  background-color: white;
  cursor: default;
}

ul {
  list-style-type: none;
  padding: 0;
  margin: 0;
  height: 100%;
}

li {
  display: flex;
  padding: 0.5em;
}

li>span{
  flex: 1;
}

.lock-room {
  flex: 0.3;
}

.icon-profile, .score-player {
  flex: 0.5;
}

.game-won-lost {
  flex: 2;
}

h2 {
  display: flex;
  justify-content: space-between;
}

.create-party {
  display: flex;
  align-items: center;
  padding: 1em;
  color: purple;
}

</style>

<div class="container-flex">
  <div class="container-item">
    <h2>
      <span>{{ 'home.table.game.title'|trans|raw }}</span>
      {% if is_admin %}
        <a class="join-link create-party border lined thick" href="">{{ 'home.table.game.create_party'|trans|raw }}</a>
      {% endif %}
    </h2>
    <div class="current-parties">
      <ul class="border lined thick">
        <li class="partie-item">
          <span class="lock-room"></span>
          <span class="name-room">{{ 'home.table.game.name'|trans|raw }}</span>
          <span class="player-joined">{{ 'home.table.game.player_joined'|trans|raw }}</span>
          <span class="join"></span>
        </li>
        {% for room in rooms %}
          {% set activeCount = 0 %}
          {% for participant in room.roomParticipants %}
            {% if participant.isActive() %}
              {% set activeCount = activeCount + 1 %}
            {% endif %}
          {% endfor %}
          <li class="partie-item {{ loop.last ? '' : 'bottom-bar' }}">
            <span class="lock-room"></span>
            <span class="name-room">{{ room.name }}</span>
            <span class="player-joined">{{ activeCount }}/{{ room.capacity }}</span>
            
            <span class="join border lined thick bottom-bar" onclick="goToLink(event)">
              <a class="join-link" href="{{ path('app_join_room', {'id': room.id}) }}">{{ 'home.table.game.join'|trans|raw }}</a>
            </span>
          </li>
        {% endfor %}
      </ul>
    
    </div>
  </div>
  <div class="container-item">
    <h2>{{ 'home.table.ranking.title'|trans|raw }}</h2>

    <div class="current-ranking">
      <ul class="ranking-tabs border lined thick">
        <li class="ranking-tab-item">
          <span class="icon-profile"></span>
          <span class="name-player">{{ 'home.table.ranking.name'|trans|raw }}</span>
          <span class="game-won-lost">{{ 'home.table.ranking.games_won'|trans|raw }}/{{ 'home.table.ranking.games_lost'|trans|raw }}</span>
          <span class="score-player">{{ 'home.table.ranking.score'|trans|raw }}</span>
        </li>
        {# {% for rank in ranks %} #}
          {# <li class="ranking-tab-item">
            <span class="icon-profile">{{ rank.profile }}</span>
            <span class="name-player">{{ rank.name }}</span>
            <span class="game-won-lost">{{ rank.win }}/{{ rank.lose }}</span>
            <span class="score-player">{{ rank.points }}</span>
          </li> #}
          {# {% endfor %} #}
      </ul>
    </div>
  </div> 
</div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>
    function goToLink(event) {
      const joinLink = event.currentTarget.querySelector('.join-link');
      window.location.href = joinLink.href;
    }
  </script>
{% endblock %}
